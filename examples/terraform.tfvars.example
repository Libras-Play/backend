# Terraform Configuration Template
# Copy this file to terraform.tfvars and customize for your environment
# ⚠️ DO NOT COMMIT terraform.tfvars WITH REAL VALUES

# =============================================================================
# PROJECT CONFIGURATION
# =============================================================================
# Project name used for resource naming
project_name = "libras-play"

# Environment: dev, staging, prod
environment = "dev"

# AWS region for deployment
region = "us-east-1"

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
# VPC CIDR block
vpc_cidr = "10.0.0.0/16"

# Availability zones (minimum 2 required for RDS)
availability_zones = ["us-east-1a", "us-east-1b"]

# Public subnet CIDRs (for ALB)
public_subnet_cidrs = ["10.0.1.0/24", "10.0.2.0/24"]

# Private subnet CIDRs (for ECS tasks)
private_subnet_cidrs = ["10.0.10.0/24", "10.0.11.0/24"]

# Database subnet CIDRs (for RDS)
database_subnet_cidrs = ["10.0.20.0/24", "10.0.21.0/24"]

# =============================================================================
# RDS DATABASE CONFIGURATION
# =============================================================================
# RDS instance class
# Options: db.t3.micro, db.t3.small, db.t3.medium, db.r5.large, etc.
db_instance_class = "db.t3.micro"  # Use db.t3.small+ for production

# Initial allocated storage (GB)
db_allocated_storage = 20

# Maximum allocated storage for auto-scaling (GB)
db_max_allocated_storage = 100

# Database engine version
db_engine_version = "15.4"

# Database name (will create content_db and user_db)
db_name = "libras_play"

# Database username (password stored in Secrets Manager)
db_username = "postgres"

# Enable Multi-AZ for production
db_multi_az = false  # Set to true for production

# Backup retention period (days)
db_backup_retention_period = 7

# Preferred backup window (UTC)
db_backup_window = "03:00-04:00"

# Preferred maintenance window (UTC)
db_maintenance_window = "sun:04:00-sun:05:00"

# Enable deletion protection for production
db_deletion_protection = false  # Set to true for production

# =============================================================================
# ECS CONFIGURATION
# =============================================================================
# ECS task CPU (256, 512, 1024, 2048, 4096)
ecs_cpu = 256  # 0.25 vCPU

# ECS task memory (MB) - must be compatible with CPU
ecs_memory = 512  # 512 MB

# Desired number of running tasks per service
ecs_desired_count = 1  # Use 2+ for production

# Maximum number of tasks per service
ecs_max_capacity = 4

# Minimum number of tasks per service
ecs_min_capacity = 1

# Enable ECS Exec for debugging
enable_ecs_exec = true  # Set to false for production

# =============================================================================
# CONTAINER IMAGE CONFIGURATION
# =============================================================================
# Container image URIs (update after pushing to ECR)
content_service_image = "ACCOUNT_ID.dkr.ecr.REGION.amazonaws.com/libras-play-content-service:latest"
user_service_image    = "ACCOUNT_ID.dkr.ecr.REGION.amazonaws.com/libras-play-user-service:latest"
ml_service_image      = "ACCOUNT_ID.dkr.ecr.REGION.amazonaws.com/libras-play-ml-service:latest"
adaptive_service_image = "ACCOUNT_ID.dkr.ecr.REGION.amazonaws.com/libras-play-adaptive-service:latest"

# Example with real account ID:
# content_service_image = "123456789012.dkr.ecr.us-east-1.amazonaws.com/libras-play-content-service:v1.2.3"

# =============================================================================
# LOAD BALANCER CONFIGURATION
# =============================================================================
# Enable HTTPS (requires certificate_arn)
enable_https = false

# SSL certificate ARN (required if enable_https = true)
certificate_arn = ""
# Example: "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"

# Custom domain name (optional)
domain_name = ""
# Example: "api.librasplay.com"

# Route 53 hosted zone ID (required if domain_name is set)
hosted_zone_id = ""
# Example: "Z1234567890ABC"

# =============================================================================
# DYNAMODB CONFIGURATION
# =============================================================================
# DynamoDB billing mode: PAY_PER_REQUEST or PROVISIONED
dynamodb_billing_mode = "PAY_PER_REQUEST"

# Read capacity units (only used if billing_mode = PROVISIONED)
dynamodb_read_capacity = 5

# Write capacity units (only used if billing_mode = PROVISIONED)
dynamodb_write_capacity = 5

# Enable point-in-time recovery
dynamodb_point_in_time_recovery = false  # Set to true for production

# =============================================================================
# COGNITO CONFIGURATION
# =============================================================================
# Cognito user pool name
cognito_user_pool_name = "libras-play-users"

# Password policy
cognito_password_minimum_length = 8
cognito_password_require_lowercase = true
cognito_password_require_numbers = true
cognito_password_require_symbols = true
cognito_password_require_uppercase = true

# Multi-factor authentication
cognito_mfa_configuration = "OFF"  # Options: OFF, ON, OPTIONAL

# =============================================================================
# S3 CONFIGURATION
# =============================================================================
# S3 bucket name for videos and ML models
s3_bucket_videos = "libras-play-videos-ENVIRONMENT-RANDOM"
s3_bucket_models = "libras-play-models-ENVIRONMENT-RANDOM"

# Enable versioning
s3_enable_versioning = true

# Enable encryption
s3_enable_encryption = true

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
# CloudWatch log retention (days)
cloudwatch_log_retention_days = 14  # Use 30+ for production

# Enable detailed monitoring
enable_detailed_monitoring = false  # Set to true for production

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Enable GuardDuty
enable_guardduty = false  # Set to true for production

# Enable Security Hub
enable_security_hub = false  # Set to true for production

# Enable Config
enable_config = false  # Set to true for production

# Allowed CIDR blocks for ALB access
allowed_cidr_blocks = ["0.0.0.0/0"]  # Restrict for production: ["1.2.3.4/32"]

# =============================================================================
# RESOURCE TAGS
# =============================================================================
tags = {
  Project     = "LibrasPlay"
  Environment = "dev"  # Change to staging/prod as needed
  ManagedBy   = "Terraform"
  Owner       = "DevOps Team"
  Cost_Center = "Engineering"
  Backup      = "Required"
  Monitoring  = "Enabled"
  Compliance  = "Required"
}

# =============================================================================
# ENVIRONMENT-SPECIFIC EXAMPLES
# =============================================================================

# -----------------------------------------------
# DEVELOPMENT ENVIRONMENT EXAMPLE
# -----------------------------------------------
# Minimal cost configuration for development
# 
# db_instance_class = "db.t3.micro"
# ecs_cpu = 256
# ecs_memory = 512  
# ecs_desired_count = 1
# dynamodb_billing_mode = "PAY_PER_REQUEST"
# enable_https = false
# db_multi_az = false

# -----------------------------------------------
# STAGING ENVIRONMENT EXAMPLE  
# -----------------------------------------------
# Moderate configuration for staging
#
# db_instance_class = "db.t3.small" 
# ecs_cpu = 512
# ecs_memory = 1024
# ecs_desired_count = 1
# dynamodb_billing_mode = "PAY_PER_REQUEST"
# enable_https = true
# certificate_arn = "arn:aws:acm:..."
# db_multi_az = false

# -----------------------------------------------
# PRODUCTION ENVIRONMENT EXAMPLE
# -----------------------------------------------
# High-availability configuration for production
#
# db_instance_class = "db.r5.large"
# ecs_cpu = 1024
# ecs_memory = 2048
# ecs_desired_count = 3
# ecs_max_capacity = 10
# dynamodb_billing_mode = "PROVISIONED"
# dynamodb_read_capacity = 100
# dynamodb_write_capacity = 100
# enable_https = true
# certificate_arn = "arn:aws:acm:..."
# domain_name = "api.librasplay.com"
# db_multi_az = true
# db_deletion_protection = true
# enable_guardduty = true
# enable_security_hub = true
# allowed_cidr_blocks = ["10.0.0.0/8", "172.16.0.0/12"]
# cloudwatch_log_retention_days = 90

# =============================================================================
# COST ESTIMATION
# =============================================================================
# Based on configuration above, estimated monthly costs:

# DEVELOPMENT (t3.micro, 1 task each):
# - ECS Fargate: ~$30-40
# - RDS: ~$15-20  
# - DynamoDB: ~$5-10
# - ALB: ~$20-25
# - Other: ~$10-15
# Total: ~$80-110/month

# PRODUCTION (r5.large, 3 tasks each):
# - ECS Fargate: ~$150-200
# - RDS: ~$150-200
# - DynamoDB: ~$50-100  
# - ALB: ~$50-75
# - Other: ~$50-75
# Total: ~$450-650/month

# =============================================================================
# SECURITY NOTES
# =============================================================================
# 
# ⚠️ NEVER COMMIT terraform.tfvars WITH REAL VALUES
# 
# ✅ DO:
# - Copy this template to terraform.tfvars
# - Customize values for your environment
# - Add terraform.tfvars to .gitignore
# - Store sensitive values in AWS Secrets Manager
# - Use least-privilege IAM policies
# - Enable encryption at rest
# - Use private subnets for services
# - Restrict security group access
# 
# ❌ DON'T:
# - Commit real AWS account IDs
# - Put database passwords here (use Secrets Manager)
# - Use overly permissive CIDR blocks in production
# - Disable security features in production
# - Use t3.micro instances for production databases